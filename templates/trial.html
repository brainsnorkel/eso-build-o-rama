{% extends "base.html" %}

{% block title %}{{ trial_name }} - Top Builds{% endblock %}

{% block meta_description %}Common meta builds from top players in {{ trial_name }}. Discover the most effective gear sets and abilities used by high-performing ESO players.{% endblock %}

{% block og_title %}{{ trial_name }} - Top Builds{% endblock %}

{% block og_description %}Common meta builds from top players in {{ trial_name }}. Discover the most effective gear sets and abilities used by high-performing ESO players.{% endblock %}

{% block og_image_alt %}{{ trial_name }} - Top Builds{% endblock %}

{% block twitter_title %}{{ trial_name }} - Common ESO Meta Builds{% endblock %}

{% block twitter_description %}Common meta builds from top players in {{ trial_name }}. Discover effective gear sets and strategies.{% endblock %}

{% block twitter_image_alt %}{{ trial_name }} - Top Builds{% endblock %}

{% block content %}
<nav aria-label="Breadcrumb" style="margin-bottom: 20px; font-size: 0.9em;">
    <ol style="list-style: none; padding: 0; margin: 0; display: flex; flex-wrap: wrap; align-items: center;">
        <li style="display: flex; align-items: center;">
            <a href="index.html" style="color: #38ef7d; text-decoration: none;">Home</a>
            <span style="color: #666; margin: 0 10px;" aria-hidden="true">/</span>
        </li>
        <li>
            <span style="color: #a8edea;" aria-current="page">{{ trial_name }}</span>
        </li>
    </ol>
</nav>

<div class="card">
    <h2>{{ trial_name }}</h2>
    <p style="color: #a8edea; margin-top: 10px;">
        Common builds from top-performing players across all boss encounters
    </p>
</div>

{% for boss_name, builds in bosses.items() %}
<div class="card">
    <h3 style="color: #38ef7d; margin-bottom: 20px;">{{ boss_name }}</h3>
    
    {% if builds %}
    <table>
        <caption class="sr-only">Builds for {{ boss_name }}</caption>
        <thead>
            <tr>
                <th scope="col">Role</th>
                <th scope="col">Build</th>
                <th scope="col">Signature Sets</th>
                <th scope="col">Frequency</th>
                <th scope="col">DPS</th>
                <th scope="col">Player Character</th>
                <th scope="col">Details</th>
            </tr>
        </thead>
        <tbody>
            {% for build in builds %}
            <tr>
                <td data-label="Role" style="text-align: center; font-size: 1.5em;">
                    {% if build.best_player.role == 'dps' %}
                        <span aria-hidden="true">‚öîÔ∏è</span>
                        <span class="sr-only">DPS</span>
                    {% elif build.best_player.role == 'healer' %}
                        <span aria-hidden="true">‚úö</span>
                        <span class="sr-only">Healer</span>
                    {% elif build.best_player.role == 'tank' %}
                        <span aria-hidden="true">üõ°Ô∏è</span>
                        <span class="sr-only">Tank</span>
                    {% else %}
                        <span aria-hidden="true">‚ùì</span>
                        <span class="sr-only">Unknown</span>
                    {% endif %}
                </td>
                <td data-label="Build"><strong>{{ build.get_display_name(abbreviated=True) }}</strong></td>
                <td data-label="Signature Sets">
                    {% set sorted_sets = build.get_sorted_sets() %}
                    {{ sorted_sets|join(', ') if sorted_sets else 'Various' }}
                </td>
                <td data-label="Frequency">{{ build.count }} players in {{ build.report_count }} reports</td>
                <td data-label="DPS">{{ build.best_player.dps|format_dps }}</td>
                <td data-label="Player Character">{{ build.best_player.player_name }} - {{ build.best_player.character_name }}</td>
                <td data-label="Details">
                    <a href="{{ build.trial_name.lower().replace(' ', '-').replace("'", "") }}-{{ build.boss_name.lower().replace(' ', '-').replace("'", "").replace('&', 'and') }}-{{ build.build_slug }}.html" 
                       style="color: #3498db; text-decoration: none;"
                       aria-label="View details for {{ build.get_display_name(abbreviated=True) }} build">
                        View Build ‚Üí
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #a8edea;">No common builds found for this boss.</p>
    {% endif %}
</div>
{% endfor %}

{% endblock %}
