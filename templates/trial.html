{% extends "base.html" %}

{% block title %}{{ trial_name }} - Common ESO Builds{% endblock %}

{% block content %}
<nav style="margin-bottom: 20px; font-size: 0.9em;">
    <a href="index.html" style="color: #38ef7d; text-decoration: none;">Home</a>
    <span style="color: #666; margin: 0 10px;">/</span>
    <span style="color: #a8edea;">{{ trial_name }}</span>
</nav>

<div class="card">
    <h2>{{ trial_name }}</h2>
    <p style="color: #a8edea; margin-top: 10px;">
        Common builds from top-performing players across all boss encounters
    </p>
</div>

{% for boss_name, builds in bosses.items() %}
<div class="card">
    <h3 style="color: #38ef7d; margin-bottom: 20px;">{{ boss_name }}</h3>
    
    {% if builds %}
    <table>
        <thead>
            <tr>
                <th>Role</th>
                <th>Build</th>
                <th>Sets</th>
                <th>Frequency</th>
                <th>DPS</th>
                <th>Player</th>
                <th>Details</th>
            </tr>
        </thead>
        <tbody>
            {% for build in builds %}
            <tr>
                <td data-label="Role" style="text-align: center; font-size: 1.5em;">
                    {% if build.best_player.role == 'dps' %}
                        ‚öîÔ∏è
                    {% elif build.best_player.role == 'healer' %}
                        ‚úö
                    {% elif build.best_player.role == 'tank' %}
                        üõ°Ô∏è
                    {% else %}
                        ‚ùì
                    {% endif %}
                </td>
                <td data-label="Build"><strong>{{ build.get_display_name() }}</strong></td>
                <td data-label="Sets">
                    {% set sorted_sets = build.get_sorted_sets() %}
                    {{ sorted_sets|join(', ') if sorted_sets else 'Various' }}
                </td>
                <td data-label="Frequency">{{ build.count }} players in {{ build.report_count }} reports</td>
                <td data-label="DPS">{{ build.best_player.dps|format_dps }}</td>
                <td data-label="Player">{{ build.best_player.player_name }}</td>
                <td data-label="Details"><a href="{{ build.trial_name.lower().replace(' ', '-').replace("'", "") }}-{{ build.boss_name.lower().replace(' ', '-').replace("'", "").replace('&', 'and') }}-{{ build.build_slug }}.html" style="color: #3498db; text-decoration: none;">View Build ‚Üí</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p style="color: #a8edea;">No common builds found for this boss.</p>
    {% endif %}
</div>
{% endfor %}

{% endblock %}
